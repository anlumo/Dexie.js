{"version":3,"sources":["dexie-syncable.js"],"names":["global","factory","exports","module","require","define","amd","Dexie","Syncable","this","Promise$1","Promise","initPersistedContext","node","PersistedContext","prototype","save","vip","nodeID","otherProps","extend","CREATE","UPDATE","DELETE","initApplyChanges","db","changes","collectedChanges","forEach","change","_a","hasOwnProperty","table","type","push","table_names","Object","keys","tables","map","transaction","table_name","specifyKeys","schema","primKey","keyPath","createChangesToApply","deleteChangesToApply","updateChangesToApply","length","bulkPut","c","obj","key","undefined","where","anyOf","raw","each","cursor","primaryKey","then","objsToPut","filter","curr","mods","setByKeyPath","bulkUpdate","bulkDelete","getBaseRevisionAndMaxClientRevision","remoteBaseRevisions","maxClientRevision","Infinity","remoteBaseRevision","i","myRevision","local","remote","mergeChange","prevChange","nextChange","clonedChange","deepClone","combineCreateAndUpdate","hadParentPath","parentPath","indexOf","substr","subPath","combineUpdateAndUpdate","initGetLocalChangesForNode","hasMoreToGive","partialsThreshold","MAX_CHANGES_PER_CHUNK","cb","getChangesSinceRevision","revision","maxChanges","maxRevision","changeSet","numChanges","partial","ignoreSource","id","nextRevision","_changes","between","until","rev","source","changeToSend","mergedChange","initGetChangesSinceRevision","getTableObjectsAsChanges","state","collection","limitReached","item","currentTable","value","currentKey","dbUploadState","tablesToUpload","shift","orderBy","brmcr","localBaseRevision","additionalChanges","nodeModificationsOnAck","concat","initGetTableObjectsAsChanges","observable","name","resolve","last","lastChange","above","Statuses","ERROR","OFFLINE","CONNECTING","ONLINE","SYNCING","ERROR_WILL_RETRY","Promise$2","initConnectProtocol","protocolInstance","dbAliveID","options","rejectConnectPromise","enqueue","context","fn","instanceID","_enqueue","ongoingOperation","ignoreTransaction","finally","_localSyncNode","reject","DatabaseClosedError","isOpen","initEnqueue","stillAlive","activePeer","connectedContinuation","getLocalChangesForNode","url","changeStatusTo","newStatus","status","syncable","on","statusChanged","fire","broadcastMessage","catch","isNaN","doSync","getLocalChangesForNode_autoAckIfEmpty","sendChangesToProvider","finalSyncPromise","p","err","asap","sync","syncContext","appliedRemoteRevision","applyRemoteChanges","onChangesAccepted","continuation","onError","ex","error","again","setTimeout","abortTheProvider","disconnect","continueSendingChanges","autoAck","remoteChanges","remoteRevision","saveToUncommittedChanges","_uncommittedChanges","bulkAdd","changeWithNodeId","initSaveToUncommittedChanges","finallyCommitAllChanges","applyChanges","tablesToIncludeInTrans","trans","currentTransaction","localRevisionBeforeChanges","equals","toArray","uncommittedChanges","delete","currentLocalRevision","splice","console","warn","stack","initFinallyCommitAllChanges","react","e","changesWaiting","isWaitingForServer","onChanges","reactToChanges","message","unsubscribe","continueUsingReactPattern","syncAgain","continueUsingPollPattern","initConnectFn","activePeers","protocolName","existingPeer","peer","diffObject","getObjectDiff","syncOptions","execConnect","connectPromise","connectProtocol","_syncNodes","Error","equalsIgnoreCase","first","syncProtocol","put","SyncNode","lastHeartBeat","Date","now","PersistedContext_1","initialUpload","toCollection","lastKey","currentRevision","add","initGetOrCreateSyncNode","getOrCreateSyncNode","disconnected","Events","pos","override","Observable","connectFn","syncableConnect","connect","isMaster","masterNode","sendMessage","wantReply","hasBeenClosed","hasFailed","InvalidStateError","get","open","initSyncableConnect","msg","weBecameMaster","connectedRemoteNodes","all","and","getStatus","getOptions","list","a","modify","registeredProtocols","nodeIDsToDelete","nodes","nodeIDs","deleteOldChanges","unsyncedChanges","close","origClose","apply","arguments","defineProperty","enumerable","configurable","writable","_this","StatusTexts","-1","0","1","2","3","4","registerSyncProtocol","addons"],"mappings":"CAmBC,SAAUA,EAAQC,GACC,iBAAZC,SAA0C,oBAAXC,OAAyBA,OAAOD,QAAUD,EAAQG,QAAQ,SAAUA,QAAQ,qBAChG,mBAAXC,QAAyBA,OAAOC,IAAMD,OAAO,CAAC,QAAS,oBAAqBJ,IAClFD,EAAOO,MAAQP,EAAOO,OAAS,GAAIP,EAAOO,MAAMC,SAAWP,EAAQD,EAAOO,SAH5E,CAIEE,KAAM,SAAWF,GAAS,aAI5B,IAAIG,GAFJH,EAAQ,YAAaA,EAAQA,EAAe,QAAIA,GAE1BI,QA2EtB,SAASC,EAAqBC,GAI1B,OAMIC,EAAiBC,UAAUC,KAAO,WAE9B,OAAOT,EAAMU,IAAI,WACb,OAAOJ,EAAKG,UAGbF,EAXP,SAASA,EAAiBI,EAAQC,GAC9BV,KAAKS,OAASA,EACVC,GACAZ,EAAMa,OAAOX,KAAMU,IA2HnC,IAAIE,EAAS,EACTC,EAAS,EACTC,EAAS,EA0Bb,SAASC,EAAiBC,GACtB,OAAO,SAAsBC,GACzB,IAAIC,EAAmB,GACvBD,EAAQE,QAAQ,SAAUC,GACtB,IAAIC,EACCH,EAAiBI,eAAeF,EAAOG,SACxCL,EAAiBE,EAAOG,SAAUF,EAAK,IAAOT,GAAU,GAAIS,EAAGP,GAAU,GAAIO,EAAGR,GAAU,GAAIQ,IAElGH,EAAiBE,EAAOG,OAAOH,EAAOI,MAAMC,KAAKL,KAErD,IAAIM,EAAcC,OAAOC,KAAKV,GAC1BW,EAASH,EAAYI,IAAI,SAAUP,GAAS,OAAOP,EAAGO,MAAMA,KAChE,OAAOP,EAAGe,YAAY,KAAMF,EAAQ,WAChCH,EAAYP,QAAQ,SAAUa,GAC1B,IAAIT,EAAQP,EAAGO,MAAMS,GACjBC,GAAeV,EAAMW,OAAOC,QAAQC,QACpCC,EAAuBnB,EAAiBc,GAAYpB,GACpD0B,EAAuBpB,EAAiBc,GAAYlB,GACpDyB,EAAuBrB,EAAiBc,GAAYnB,GACtB,EAA9BwB,EAAqBG,QACrBjB,EAAMkB,QAAQJ,EAAqBP,IAAI,SAAUY,GAAK,OAAOA,EAAEC,MAASV,EACpEI,EAAqBP,IAAI,SAAUY,GAAK,OAAOA,EAAEE,WAAUC,GACjC,EAA9BN,EAAqBC,QA9CzC,SAAoBjB,EAAON,GACvB,IAAIW,EAAOX,EAAQa,IAAI,SAAUY,GAAK,OAAOA,EAAEE,MAC3Cd,EAAM,GAGHP,EAAMuB,MAAM,OAAOC,MAAMnB,GAAMoB,MAAMC,KAAK,SAAUN,EAAKO,GAC5DpB,EAAIoB,EAAOC,WAAa,IAAMR,IAC/BS,KAAK,WAGJ,IAGIC,EAHmBpC,EAAQqC,OAAO,SAAUZ,GAAK,OAAOZ,EAAIR,eAAeoB,EAAEE,IAAM,MAGtDd,IAAI,SAAUY,GAC3C,IAAIa,EAAOzB,EAAIY,EAAEE,IAAM,IAIvB,OAHAjB,OAAOC,KAAKc,EAAEc,MAAMrC,QAAQ,SAAUiB,GAClCtC,EAAM2D,aAAaF,EAAMnB,EAASM,EAAEc,KAAKpB,MAEtCmB,IAEX,OAAOhC,EAAMkB,QAAQY,KA2BTK,CAAWnC,EAAOgB,GACY,EAA9BD,EAAqBE,QACrBjB,EAAMoC,WAAWrB,EAAqBR,IAAI,SAAUY,GAAK,OAAOA,EAAEE,YA+DtF,SAASgB,EAAoCxD,GAEzC,GAAwC,IAApCA,EAAKyD,oBAAoBrB,OACzB,MAAO,CAEHsB,kBAAmBC,EAAAA,EACnBC,mBAAoB,MAE5B,IAAK,IAAIC,EAAI7D,EAAKyD,oBAAoBrB,OAAS,EAAQ,GAALyB,IAAUA,EACxD,GAAI7D,EAAK8D,YAAc9D,EAAKyD,oBAAoBI,GAAGE,MAE/C,MAAO,CACHL,kBAAmBG,IAAM7D,EAAKyD,oBAAoBrB,OAAS,EAAIuB,EAAAA,EAAW3D,EAAKyD,oBAAoBI,EAAI,GAAGE,MAC1GH,mBAAoB5D,EAAKyD,oBAAoBI,GAAGG,QAK5D,MAAO,CACHN,kBAAmB1D,EAAKyD,oBAAoB,GAAGM,MAC/CH,mBAAoB,MAkC5B,SAASK,EAAYC,EAAYC,GAC7B,OAAQD,EAAW9C,MACf,KAAKZ,EACD,OAAQ2D,EAAW/C,MACf,KAAKZ,EACD,OAAO2D,EACX,KAAK1D,EACD,OArCpB,SAAgCyD,EAAYC,GACxC,IAAIC,EAAe1E,EAAM2E,UAAUH,GAInC,OAHA3C,OAAOC,KAAK2C,EAAWf,MAAMrC,QAAQ,SAAUiB,GAC3CtC,EAAM2D,aAAae,EAAa7B,IAAKP,EAASmC,EAAWf,KAAKpB,MAE3DoC,EAgCgBE,CAAuBJ,EAAYC,GAC9C,KAAKzD,EACD,OAAOyD,EAEf,MACJ,KAAK1D,EACD,OAAQ0D,EAAW/C,MACf,KAAKZ,EACD,OAAO2D,EACX,KAAK1D,EACD,OAvCpB,SAAgCyD,EAAYC,GACxC,IAAIC,EAAe1E,EAAM2E,UAAUH,GAkBnC,OAjBA3C,OAAOC,KAAK2C,EAAWf,MAAMrC,QAAQ,SAAUiB,GAE3C,IAAIuC,GAAgB,EACpBhD,OAAOC,KAAK0C,EAAWd,MAAMF,OAAO,SAAUsB,GAAc,OAA6C,IAAtCxC,EAAQyC,QAAQD,EAAa,OAAezD,QAAQ,SAAUyD,GAC7H9E,EAAM2D,aAAae,EAAahB,KAAKoB,GAAaxC,EAAQ0C,OAAOF,EAAWpC,OAAS,GAAI+B,EAAWf,KAAKpB,IACzGuC,GAAgB,IAEfA,IAEDH,EAAahB,KAAKpB,GAAWmC,EAAWf,KAAKpB,IAIjDT,OAAOC,KAAK0C,EAAWd,MAAMF,OAAO,SAAUyB,GAAW,OAA0C,IAAnCA,EAAQF,QAAQzC,EAAU,OAAejB,QAAQ,SAAU4D,UAChHP,EAAahB,KAAKuB,OAG1BP,EAoBgBQ,CAAuBV,EAAYC,GAC9C,KAAKzD,EACD,OAAOyD,EAEf,MACJ,KAAKzD,EACD,OAAQyD,EAAW/C,MACf,KAAKZ,EACD,OAAO2D,EACX,KAAK1D,EAEL,KAAKC,EACD,OAAOwD,IA4G3B,SAASW,EAA2BjE,EAAIkE,EAAeC,GACnD,IAAIC,EAAwBD,EAC5B,OAAO,SAAgC/E,EAAMiF,GAOzC,IAAIC,EA/GZ,SAAqCtE,EAAIZ,EAAM8E,GAC3C,OAAO,SAAiCK,EAAUC,EAAYC,EAAaJ,GAEvE,IAAIK,EAAY,GACZC,EAAa,EACbC,GAAU,EACVC,EAAezF,EAAK0F,GACpBC,EAAeR,EACnB,OAAOvE,EAAGe,YAAY,IAAKf,EAAGgF,SAAU,WAEpC,OADYhF,EAAGgF,SAASlD,MAAM,OAAOmD,QAAQV,EAAUE,GAAa,GAAO,GAC9DS,MAAM,WACf,GAAIP,IAAeH,EAEf,OADAI,GAAU,IAGf3C,KAAK,SAAU7B,GAId,GAFA2E,EAAe3E,EAAO+E,IAElB/E,EAAOgF,SAAWP,EAAtB,CAGA,IAAIQ,EAAe,CACf7E,KAAMJ,EAAOI,KACbD,MAAOH,EAAOG,MACdqB,IAAKxB,EAAOwB,KAEZxB,EAAOI,OAASZ,EAChByF,EAAa1D,IAAMvB,EAAOuB,IACrBvB,EAAOI,OAASX,IACrBwF,EAAa7C,KAAOpC,EAAOoC,MAC/B,IAAIsC,EAAK1E,EAAOG,MAAQ,IAAMH,EAAOwB,IACjC0B,EAAaoB,EAAUI,GAC3B,GAAKxB,EAKA,CAED,IACIgC,EAAejC,EAAYC,EADd+B,GAEjBX,EAAUI,GAAMQ,OAPhBZ,EAAUI,GAAMO,IACdV,OASXvC,KAAK,WACJ,IAAInC,EAAUU,OAAOC,KAAK8D,GAAW5D,IAAI,SAAUc,GAC/C,OAAO8C,EAAU9C,KAGrB,OADAsC,EAAcA,cAAgBU,EACvBP,EAAGpE,EAAS2E,EAAS,CAAE1B,WAAY6B,OA6DhBQ,CAA4BvF,EAAIZ,EAAM8E,GAChEsB,EAzDZ,SAAsCxF,EAAIZ,EAAMgF,EAAuBE,EAAyBJ,EAAeG,GAC3G,OAAO,SAASmB,EAAyBC,EAAOxF,EAASyF,GAIrD,IAAIC,GAAe,EACnB,OAAOD,EAAWR,MAAM,WACpB,GAAIjF,EAAQuB,SAAW4C,EAEnB,OADAuB,GAAe,IAGpB1D,KAAK,SAAU2D,EAAM1D,GACpBjC,EAAQQ,KAAK,CACTD,KAAMZ,EACNW,MAAOkF,EAAMI,aACbjE,IAAKM,EAAON,IACZD,IAAKO,EAAO4D,QAEhBL,EAAMM,WAAa7D,EAAON,MAC3BQ,KAAK,WACJ,GAAIuD,EAGA,OADAzB,EAAcA,eAAgB,EACvBG,EAAGpE,EAAS,MAAM,EAAM,CAAE+F,cAAeP,IAIhD,GAAoC,IAAhCA,EAAMQ,eAAezE,OAarB,OADAiE,EAAMI,aAAeJ,EAAMQ,eAAeC,QACnCV,EAAyBC,EAAOxF,EAASD,EAAGO,MAAMkF,EAAMI,cAAcM,QAAQ,QAVrF,IAAIC,EAAQxD,EAAoCxD,GAChD,OAAOkF,EAAwBmB,EAAMY,kBAAmBjC,EAAwBnE,EAAQuB,OAAQ4E,EAAMtD,kBAAmB,SAAUwD,EAAmB1B,EAAS2B,GAG3J,OAFAtG,EAAUA,EAAQuG,OAAOF,GACzBC,EAAuBP,cAAgB,KAChC3B,EAAGpE,EAASmG,EAAMpD,mBAAoB4B,EAAS2B,QAuBvCE,CAA6BzG,EAAIZ,EAAMgF,EAAuBE,EAAyBJ,EAAeG,GAGrI,GAAuB,GAAnBjF,EAAK8D,WAAiB,CAEtB,IAAIkD,EAAQxD,EAAoCxD,GAChD,OAAOkF,EAAwBlF,EAAK8D,WAAYkB,EAAuBgC,EAAMtD,kBAAmB,SAAU7C,EAAS2E,EAAS2B,GACxH,OAAOlC,EAAGpE,EAASmG,EAAMpD,mBAAoB4B,EAAS2B,KAM1D,GAA2B,OAAvBnH,EAAK4G,cAAwB,CAE7B,IAAIC,EAAiBjG,EAAGa,OAAOyB,OAAO,SAAU/B,GAC5C,OAAOA,EAAMW,OAAOwF,aACrB5F,IAAI,SAAUP,GACb,OAAOA,EAAMoG,OAEjB,GAA8B,IAA1BV,EAAezE,OACf,OAAO1C,EAAMI,QAAQ0H,QAAQvC,EAAG,GAAI,MAAM,EAAO,KACrD,IAAI2B,EAAgB,CAChBC,eAAgBA,EAChBJ,aAAcI,EAAeC,QAC7BH,WAAY,MAEhB,OAAO/F,EAAGgF,SAASmB,QAAQ,OAAOU,KAAK,SAAUC,GAC7Cd,EAAcK,kBAAqBS,GAAcA,EAAW3B,KAAQ,EACpE,IAAIO,EAAa1F,EAAGO,MAAMyF,EAAcH,cAAcM,QAAQ,OAC9D,OAAOX,EAAyBQ,EAAe,GAAIN,KAGtD,GAAItG,EAAK4G,cAAcD,WAAY,CACpC,IAAIL,EAAa1F,EAAGO,MAAMnB,EAAK4G,cAAcH,cAAc/D,MAAM,OAAOiF,MAAM3H,EAAK4G,cAAcD,YACjG,OAAOP,EAAyB1G,EAAM2E,UAAUrE,EAAK4G,eAAgB,GAAIN,GAGrEA,EAAa1F,EAAGO,MAAMyF,EAAcH,cAAcM,QAAQ,OAC9D,OAAOX,EAAyB1G,EAAM2E,UAAUrE,EAAK4G,eAAgB,GAAIN,IAMzF,IAAIsB,EAAW,CACXC,OAAQ,EACRC,QAAS,EACTC,WAAY,EACZC,OAAQ,EACRC,QAAS,EACTC,iBAAkB,GAWlBC,EAAYzI,EAAMI,QACtB,SAASsI,EAAoBxH,EAAIyH,EAAkBC,EAAWC,EAASC,GACnE,IAAIC,EA3bR,SAAqB7H,GACjB,OAAO,SAAS6H,EAAQC,EAASC,EAAIC,GACjC,SAASC,IAeL,OAdKH,EAAQI,iBAUTJ,EAAQI,iBAAmBJ,EAAQI,iBAAiB9F,KAAK,WACrD,OAAOyF,EAAQC,EAASC,EAAIC,KAVhCF,EAAQI,iBAAmBpJ,EAAMqJ,kBAAkB,WAC/C,OAAOrJ,EAAMU,IAAI,WACb,OAAOuI,QAEZK,QAAQ,kBACAN,EAAQI,mBAQhBJ,EAAQI,iBAEnB,OAAKF,EASIhI,EAAGqI,gBAAkBL,IAAehI,EAAGqI,eAAevD,GAEpDmD,IAGAnJ,EAAMI,QAAQoJ,OAAO,IAAIxJ,EAAMyJ,qBAZlCvI,EAAGwI,SACIP,IAGAnJ,EAAMI,QAAQoJ,OAAO,IAAIxJ,EAAMyJ,sBAkapCE,CAAYzI,GACtBkE,EAAgB,CAAEA,eAAe,GACrC,SAASwE,IAGL,OAAO1I,EAAGqI,gBAAkBrI,EAAGqI,eAAevD,KAAO4C,EAEzD,OAAO,SAAyBtI,EAAMuJ,GAElC,IAiBIC,EAjBAC,EAAyB5E,EAA2BjE,EAAIkE,EAAeuD,EAAiBtD,mBACxF2E,EAAMH,EAAWG,IACrB,SAASC,EAAeC,GAChB5J,EAAK6J,SAAWD,IAChB5J,EAAK6J,OAASD,EACd5J,EAAKG,OAAO6C,KAAK,WACbpC,EAAGkJ,SAASC,GAAGC,cAAcC,KAAKL,EAAWF,GAE7C9I,EAAG0G,WAAW4C,iBAAiB,oBAAqB,CAAEN,UAAWA,EAAWF,IAAKA,IAAO,KACzFS,MAAM,sBAAuB,eAUxC,OANAZ,EAAWQ,GAAG,aAAc,SAAUH,GAC7BQ,MAAMR,IACPD,EAAeC,KAGvBD,EAAe/B,EAASG,YACjBsC,IACP,SAASA,IAEL,OAAO5B,EAAQ4B,EAAQ,WAEnB,OAAOC,EAAsCtK,EAAMuK,IACpDjC,GAEP,SAASiC,EAAsB1J,EAAS+C,EAAoB4B,EAAS2B,GAGjE,IAAIqD,EAAmB,IAAIrC,EAAU,SAAUX,EAAS0B,GACpDV,EAAqBiC,EAAI,SAAUC,GAC/BxB,EAAOwB,IAEXhL,EAAMiL,KAAK,WACP,IACItC,EAAiBuC,KAAK5K,EAAK6K,YAAanB,EAAKnB,EAAS3E,EAAoB5D,EAAK8K,sBAAuBjK,EAAS2E,EAASuF,EAAoBC,EAAmB,SAAUC,GACrKzD,EAAQyD,IACTC,GAEP,MAAOC,GACHD,EAAQC,EAAIxH,EAAAA,GAEhB,SAASuH,EAAQE,EAAOC,GACpBnC,EAAOkC,GACH9B,OACKc,MAAMiB,IAAUA,EAAQ1H,EAAAA,GACzB2H,WAAW,WACHhC,MACAK,EAAe/B,EAASK,SACxBoC,IAASF,MAAM,sBAAuBoB,KAE3CF,GACH1B,EAAe/B,EAASM,kBACpBsB,GAAyBA,EAAsBgC,YAC/ChC,EAAsBgC,aAC1BhC,EAAwB,MAGxB+B,EAAiBH,SAMrC,OAAOZ,EAAiBxH,KAAK,cAG1BgG,QAAQ,WAIPR,EAAqBiC,EAAI,OAE7B,SAASO,IAOL,OANAzJ,OAAOC,KAAK2F,GAAwBpG,QAAQ,SAAUiB,GAClDtC,EAAM2D,aAAarD,EAAMgC,EAASmF,EAAuBnF,MAI7DwI,EAAiBxH,KAAKyI,GACfzL,EAAKG,QAGpB,SAASoL,EAAiBH,GACtB7B,EAAWiC,WAAW5D,EAASC,MAAOuD,GAE1C,SAASd,EAAsCtK,EAAMiF,GACjD,OAAOwE,EAAuBzJ,EAAM,SAAS0L,EAAQ7K,EAAS+C,EAAoB4B,EAAS2B,GACvF,OAAuB,IAAnBtG,EAAQuB,QAAgB,eAAgB+E,GAA0BA,EAAuBrD,aAAe9D,EAAK8D,YAC7GvC,OAAOC,KAAK2F,GAAwBpG,QAAQ,SAAUiB,GAClDtC,EAAM2D,aAAarD,EAAMgC,EAASmF,EAAuBnF,MAE7DhC,EAAKG,OAAOgK,MAAM,sBAAuB,cAElCV,EAAuBzJ,EAAM0L,IAG7BzG,EAAGpE,EAAS+C,EAAoB4B,EAAS2B,KAI5D,SAAS4D,EAAmBY,EAAeC,EAAgBpG,GACvD,IAAIqG,EArgBhB,SAAsCjL,EAAIZ,GACtC,OAAO,SAAkCa,EAAS+K,GAC9C,OAAOhL,EAAGe,YAAY,MAAOf,EAAGkL,oBAAqB,WACjD,OAAOlL,EAAGkL,oBAAoBC,QAAQlL,EAAQa,IAAI,SAAUV,GACxD,IAAIgL,EAAmB,CACnBhM,KAAMA,EAAK0F,GACXtE,KAAMJ,EAAOI,KACbD,MAAOH,EAAOG,MACdqB,IAAKxB,EAAOwB,KAMhB,OAJIxB,EAAOuB,MACPyJ,EAAiBzJ,IAAMvB,EAAOuB,KAC9BvB,EAAOoC,OACP4I,EAAiB5I,KAAOpC,EAAOoC,MAC5B4I,OAEZhJ,KAAK,WAEJ,OADAhD,EAAK8K,sBAAwBc,EACtB5L,EAAKG,UAmfmB8L,CAA6BrL,EAAIZ,GAC5DkM,EAnbhB,SAAqCtL,EAAIZ,GACrC,IAAImM,EAAexL,EAAiBC,GACpC,OAAO,SAAiCC,EAAS+K,GAE7C,IAAIQ,EAAyBxL,EAAGa,OAAOyB,OAAO,SAAU/B,GAAS,MAAsB,aAAfA,EAAMoG,MAC3D,wBAAfpG,EAAMoG,MACNpG,EAAMW,OAAOwF,aACjB,OAAO1G,EAAGe,YAAY,MAAOyK,EAAwB,WACjD,IAAIC,EAAQ3M,EAAM4M,mBACdC,EAA6B,EACjC,OAAO3L,EAAGgF,SAASmB,QAAQ,OAAOU,KAAK,SAAUC,GAE7C6E,EAA8B7E,GAAcA,EAAW3B,KAAQ,IAChE/C,KAAK,WAIJ,OAFAqJ,EAAMrG,OAAShG,EAAK0F,GAEb9E,EAAGkL,oBAAoBpJ,MAAM,QAAQ8J,OAAOxM,EAAK0F,IAAI+G,YAC7DzJ,KAAK,SAAU0J,GACd,OAAOP,EAAaO,KACrB1J,KAAK,WACJ,OAAOpC,EAAGkL,oBAAoBpJ,MAAM,QAAQ8J,OAAOxM,EAAK0F,IAAIiH,WAC7D3J,KAAK,WAEJ,OAAOmJ,EAAatL,KACrBmC,KAAK,WAEJ,OAAOpC,EAAGgF,SAASmB,QAAQ,OAAOU,SACnCzE,KAAK,SAAU0E,GACd,IAAIkF,EAAwBlF,GAAcA,EAAW3B,KAAQ,EAW7D,GATA/F,EAAK8K,sBAAwBc,EAC7B5L,EAAKyD,oBAAoBpC,KAAK,CAAE2C,OAAQ4H,EAAgB7H,MAAO6I,IAC3D5M,EAAK8D,aAAeyI,IAIpBvM,EAAK8D,WAAa8I,GAGgB,EAAlC5M,EAAKyD,oBAAoBrB,OACzB,IAAK,IAAIyB,EAAI7D,EAAKyD,oBAAoBrB,OAAS,EAAO,EAAJyB,IAASA,EACvD,GAAI7D,EAAK8D,YAAc9D,EAAKyD,oBAAoBI,GAAGE,MAAO,CACtD/D,EAAKyD,oBAAoBoJ,OAAO,EAAGhJ,GACnC,MAKZ7D,EAAKG,OAAOgK,MAAM,SAAUO,GACxBoC,QAAQC,KAAK,2EAA6ErC,EAAIsC,OAAStC,WAiYjFuC,CAA4BrM,EAAIZ,GAC9D,OAAOyI,EAAQsC,EAAoB,WAC/B,OAAKzB,KAGG9D,EAAUqG,EAAyBF,EAAeC,GAAkBM,EAAwBP,EAAeC,IAC9GzB,MAAM,SAAUiB,GAEjB,OADAG,EAAiBH,GACVjD,EAAUe,OAAOkC,KALjBjD,EAAUe,OAAO,IAAIxJ,EAAMyJ,sBAOvCb,GAOP,SAASmD,EAAuBR,GACvB3B,KAKLE,EAAwByB,EACxB1B,EAAWQ,GAAG,aAAc,WACxB,GAAIP,EAAuB,CACvB,GAAIA,EAAsB0D,MACtB,IAEI1D,EAAsBgC,aAE1B,MAAO2B,IAGX3D,EAAwB,QAG5ByB,EAAaiC,MAQrB,SAAmCjC,GAC/B,IAAImC,EACJC,EACA,SAASC,IACD9D,IACAG,EAAe/B,EAASK,SACpBoF,EACAD,GAAiB,EAEjBG,KAQZ,SAASA,IACA/D,IAGL6D,IADAD,GAAiB,GAEjB9C,EAAsCtK,EAAM,SAAUa,EAAS+C,EAAoB4B,EAAS2B,GACnFqC,IAEgB,EAAjB3I,EAAQuB,OACR6I,EAAaiC,MAAMrM,EAAS+C,EAAoB4B,EAAS,WACrDjE,OAAOC,KAAK2F,GAAwBpG,QAAQ,SAAUiB,GAClDtC,EAAM2D,aAAarD,EAAMgC,EAASmF,EAAuBnF,MAE7DhC,EAAKG,OAAOgK,MAAM,sBAAuB,cAGzCoD,OAIJF,GAAqB,EACjBD,EAGAG,IAGA5D,EAAe/B,EAASI,YAGjCmC,MAAM,SAAUgB,GACf2B,QAAQ1B,MAAM,OAASD,EAAGqC,QAAU,6BACpCjC,EAAiBJ,MApCzBvK,EAAGmJ,GAAG,UAAWuD,GACjB/D,EAAWQ,GAAG,aAAc,WACxBnJ,EAAGmJ,GAAGlJ,QAAQ4M,YAAYH,KAqC9BC,IA3DIG,CAA0BzC,GA8DlC,WACI,SAAS0C,IACLrD,EAAsCtK,EAAM,SAAUa,EAAS+C,EAAoB4B,EAAS2B,GACxFkB,EAAiBuC,KAAK5K,EAAK6K,YAAanB,EAAKnB,EAAS3E,EAAoB5D,EAAK8K,sBAAuBjK,EAAS2E,EAASuF,EACxH,WACIxJ,OAAOC,KAAK2F,GAAwBpG,QAAQ,SAAUiB,GAClDtC,EAAM2D,aAAarD,EAAMgC,EAASmF,EAAuBnF,MAE7DhC,EAAKG,OAAOgK,MAAM,sBAAuB,eAG7C,SAAmBc,GACf,IAAKzB,EAED,OAEJA,EAAwByB,EACpBzF,EAEAmI,KAIKvD,MAAMa,EAAaI,QAAUJ,EAAaI,MAAQ1H,EAAAA,GAEnDgG,EAAe/B,EAASI,QACxBsD,WAAW,WACH9B,IACAG,EAAe/B,EAASK,SACxB0F,MAEL1C,EAAaI,QAKhB9B,EAAWiC,WAAW5D,EAASE,UAI3C,SAAiBsD,EAAOC,IACfjB,MAAMiB,IAAUA,EAAQ1H,EAAAA,EACrB6F,IACA8B,WAAW,WACH9B,IACAG,EAAe/B,EAASK,SACxB0F,MAELtC,GACH1B,EAAe/B,EAASM,mBAI5BqD,EAAiBH,OAG1BjB,MAAMoB,GAETzG,EAAcA,cACd6I,IAEKnE,IAA0BY,MAAMZ,EAAsB6B,QAAU7B,EAAsB6B,MAAQ1H,EAAAA,GACnGgG,EAAe/B,EAASI,QACxBsD,WAAW,WACH9B,IACAG,EAAe/B,EAASK,SACxB0F,MAELnE,EAAsB6B,QAKzB9B,EAAWiC,WAAW5D,EAASE,SApI/B8F,IAtBI3C,EAAaO,YACbP,EAAaO,eA+JjC,SAASqC,EAAcjN,EAAIkN,GACvB,OAAO,SAAiBzF,EAAkB0F,EAAcrE,EAAKnB,EAASD,GAElE,IAAI0F,EAAeF,EAAY5K,OAAO,SAAU+K,GAC5C,OAAOA,EAAKvE,MAAQA,IAExB,GAA0B,EAAtBsE,EAAa5L,OAAY,CACzB,IAAImH,EAAayE,EAAa,GAC1BE,EAAa,GAIjB,OAHAxO,EAAMyO,cAAc5E,EAAW6E,YAAa7F,EAAS2F,GAGd,IAAnC3M,OAAOC,KAAK0M,GAAY9L,OACjBxB,EAAGkJ,SAAS0B,WAAW9B,GACzB1G,KAAK,WACN,OAAOqL,MAMJL,EAAa,GAAGM,eAG/B,SAASD,IAGL,IAAI7F,EAAuB,CAAEiC,EAAG,MAC5B8D,EAAkBnG,EAAoBxH,EAAIyH,EAAkBC,EAAWC,EAASC,GAEhF8F,EA9yBhB,SAAiC1N,EAAImN,EAAcrE,GAC/C,OAAO,SAA6BnB,GAChC,OAAO3H,EAAGe,YAAY,KAAMf,EAAG4N,WAAY5N,EAAGgF,SAAU,WACpD,IAAK8D,EACD,MAAM,IAAI+E,MAAM,uBAEpB,OAAO7N,EAAG4N,WAAW9L,MAAM,OAAOgM,iBAAiBhF,GAAKiF,MAAM,SAAU3O,GAGpE,GAAIA,EAAM,CACN,IAAIC,EAAmBF,EAAqBC,GAE5CA,EAAK6K,YAAc,IAAI5K,EAAiBD,EAAK0F,GAAI1F,EAAK6K,aACtD7K,EAAK4O,aAAeb,EACpB/N,EAAKoO,YAAc7F,EACnB3H,EAAG4N,WAAWK,IAAI7O,OAEjB,EAEDA,EAAO,IAAIY,EAAG0G,WAAWwH,UACpBhL,YAAc,EACnB9D,EAAK8K,sBAAwB,KAC7B9K,EAAKyD,oBAAsB,GAC3BzD,EAAKoB,KAAO,SACZpB,EAAK4O,aAAeb,EACpB/N,EAAK0J,IAAMA,EACX1J,EAAKoO,YAAc7F,EACnBvI,EAAK+O,cAAgBC,KAAKC,MAC1BjP,EAAK4G,cAAgB,KACrB,IAAIsI,EAAqBnP,EAAqBC,GAC9CN,EAAMI,QAAQ0H,QAAQ,WAElB,IAA8B,IAA1Be,EAAQ4G,cACR,OAAOvO,EAAGgF,SAASwJ,eAAeC,QAAQ,SAAUC,GAChDtP,EAAK8D,WAAawL,IAJR,IAMjBtM,KAAK,WACNpC,EAAG4N,WAAWe,IAAIvP,GAAMgD,KAAK,SAAU3C,GACnCL,EAAK6K,YAAc,IAAIqE,EAAmB7O,GAC1CO,EAAG4N,WAAWK,IAAI7O,OAI9B,OAAOA,OAkwBewP,CAAwB5O,EAAImN,EAAcrE,EAC/C+F,CAAoBlH,GAASvF,KAAK,SAAUhD,GAC7D,OAAOuO,EAAgBvO,EAAMuJ,KAE7BmG,GAAe,EACfnG,EAAa,CACbG,IAAKA,EACLG,OAAQjC,EAASE,QACjBwG,eAAgBA,EAChBF,YAAa7F,EACbwB,GAAIrK,EAAMiQ,OAAO,KAAM,cACvBnE,WAAY,SAAU5B,EAAWwB,GAC7B,IAAIwE,EAAM9B,EAAYrJ,QAAQ8E,GACnB,GAAPqG,GACA9B,EAAYjB,OAAO+C,EAAK,GACxBxE,GAAS5C,EAAqBiC,GAC9BjC,EAAqBiC,EAAEW,GACtBsE,GACDnG,EAAWQ,GAAGyB,WAAWvB,KAAKL,EAAWwB,GAE7CsE,GAAe,IAIvB,OADA5B,EAAYzM,KAAKkI,GACV+E,EAEX,OAAOD,KA0Bf,IAAIwB,EAAWnQ,EAAMmQ,SACjB/P,EAAUJ,EAAMI,QAChBgQ,EAAapQ,EAAMoQ,WACvB,SAASnQ,EAASiB,GAEd,IAAIkN,EAAc,GACdiC,EAAYlC,EAAcjN,EAAIkN,GAC9BkC,EAt8BR,SAA6BpP,EAAIqP,GAC7B,OAAO,SAAyB5H,EAAkB0F,EAAcrE,EAAKnB,GACjE,GAAI3H,EAAGwI,SAAU,CAEb,IAAKxI,EAAGqI,eACJ,MAAM,IAAIwF,MAAM,0FACpB,OAAI7N,EAAGqI,eAAeiH,SAEXD,EAAQ5H,EAAkB0F,EAAcrE,EAAKnB,EAAS3H,EAAGqI,eAAevD,IAKxE9E,EAAGO,MAAM,cAAcuB,MAAM,YAAYiF,MAAM,GAAGgH,MAAM,SAAUwB,GAErE,OAAOvP,EAAG0G,WAAW8I,YAAY,UAAW,CACxCrC,aAAcA,EACdrE,IAAKA,EACLnB,QAASA,GACV4H,EAAWzK,GAAI,CAAE2K,WAAW,MAItC,OAAIzP,EAAG0P,gBAEDzQ,EAAUqJ,OAAO,IAAIxJ,EAAMyJ,qBAE7BvI,EAAG2P,YAED1Q,EAAUqJ,OAAO,IAAIxJ,EAAM8Q,kBAAkB,gEAKtC,IAAI3Q,EAAU,SAAU2H,EAAS0B,GAC3CtI,EAAGmJ,GAAG,QAAS,WAIX,OAAOnJ,EAAG4N,WAAWiC,IAAI,CAAE/G,IAAKA,GAAO,SAAU1J,GAI7C,IAAIsO,EAAiB1N,EAAGkJ,SAASmG,QAAQlC,EAAcrE,EAAKnB,GAG5D,GAFA+F,EAAetL,KAAKwE,EAAS0B,IAEzBlJ,IAAQA,EAAK8K,sBAajB,OAAOwD,MAIf1N,EAAG8P,OAAOvG,MAAM,SAAUgB,GAGtBjC,EAAO,IAAIxJ,EAAM8Q,kBAAkB,4DAA6DrF,SAo4B1FwF,CAAoB/P,EAAImP,GAC9CnP,EAAGmJ,GAAG,UAAW,SAAU6G,GAEvBlR,EAAMU,IAAI,WACW,YAAbwQ,EAAIxP,KAEJR,EAAGkJ,SAASmG,QAAQW,EAAIpD,QAAQO,aAAc6C,EAAIpD,QAAQ9D,IAAKkH,EAAIpD,QAAQjF,SAASvF,KAAK4N,EAAIpJ,QAASoJ,EAAI1H,QAExF,eAAb0H,EAAIxP,KACTR,EAAGkJ,SAAS0B,WAAWoF,EAAIpD,QAAQ9D,KAAK1G,KAAK4N,EAAIpJ,QAASoJ,EAAI1H,QAE5C,sBAAb0H,EAAIxP,MAGTR,EAAGkJ,SAASC,GAAGC,cAAcC,KAAK2G,EAAIpD,QAAQ5D,UAAWgH,EAAIpD,QAAQ9D,SAIjF9I,EAAGmJ,GAAG,UAAW,SAAU8G,GAEnBA,GAQAnR,EAAMqJ,kBAAkB,WAAc,OAAOrJ,EAAMU,IAAI,WACnD,OAAOQ,EAAG4N,WAAW9L,MAAM,CAAEtB,KAAM,WAC9B8B,OAAO,SAAUlD,GAAQ,OAAOA,EAAK6J,SAAWjC,EAASE,UACzD2E,QAAQ,SAAUqE,GAAwB,OAAOhR,EAAQiR,IAAID,EAAqBpP,IAAI,SAAU1B,GACjG,OAAOY,EAAGkJ,SAASmG,QAAQjQ,EAAK4O,aAAc5O,EAAK0J,IAAK1J,EAAKoO,aAAajE,MAAM,SAAUgD,GACtFL,QAAQC,KAAK,wCAA0C/M,EAAK0J,IAAM,MAAQyD,EAAEH,OAASG,eAG1FhD,MAAM,sBAAuB,gBAQ5CvJ,EAAGmJ,GAAG,QAAS,WAEPnJ,EAAGqI,gBAAkBrI,EAAGqI,eAAeiH,UAWvCtP,EAAG4N,WACE9L,MAAM,QAAQ8J,OAAO,UACrBwE,IAAI,SAAUhR,GAAQ,OAAOA,EAAK6J,SAAWjC,EAASE,UACtD2E,QAAQ,SAAUqE,GAEnBA,EAAqB/P,QAAQ,SAAUf,GAAQ,OAAOY,EAAGkJ,SAASmG,QAAQjQ,EAAK4O,aAAc5O,EAAK0J,IAAK1J,EAAKoO,aACvGjE,MAAM,kBAEZA,MAAM,sBAAuB,gBAErC,GACHvJ,EAAGkJ,SAAW,GACdlJ,EAAGkJ,SAASmH,UAAY,SAAUvH,EAAKzE,GACnC,OAAIrE,EAAGwI,SACI1J,EAAMU,IAAI,WACb,OAAOQ,EAAG4N,WAAW9L,MAAM,OAAO8J,OAAO9C,GAAKiF,MAAM,SAAU3O,GAC1D,OAAOA,EAAOA,EAAK6J,OAASjC,EAASE,YAE1C9E,KAAKiC,GAGDnF,EAAQ0H,QAAQ7H,EAASiI,SAASE,SAAS9E,KAAKiC,IAG/DrE,EAAGkJ,SAASoH,WAAa,SAAUxH,EAAKzE,GACpC,OAAOrE,EAAGe,YAAY,KAAMf,EAAG4N,WAAY,WACvC,OAAO5N,EAAG4N,WAAW9L,MAAM,OAAO8J,OAAO9C,GAAKiF,MAAM,SAAU3O,GAC1D,OAAOA,EAAKoO,cACbpL,KAAKiC,MAGhBrE,EAAGkJ,SAASqH,KAAO,WACf,OAAOvQ,EAAGe,YAAY,KAAMf,EAAG4N,WAAY,WACvC,OAAO5N,EAAG4N,WAAW9L,MAAM,QAAQ8J,OAAO,UAAUC,QAAQ,SAAU2E,GAClE,OAAOA,EAAE1P,IAAI,SAAU1B,GAAQ,OAAOA,EAAK0J,WAIvD9I,EAAGkJ,SAASC,GAAKrK,EAAMiQ,OAAO/O,EAAI,CAAEoJ,cAAe,SACnDpJ,EAAGkJ,SAAS0B,WAAa,SAAU9B,GAC/B,OAAOhK,EAAMqJ,kBAAkB,WAC3B,OAAOjJ,EAAQ0H,UAAUxE,KAAK,WAC1B,OAAIpC,EAAGqI,gBAAkBrI,EAAGqI,eAAeiH,SAChCpQ,EAAQiR,IAAIjD,EAAY5K,OAAO,SAAU+K,GAAQ,OAAOA,EAAKvE,MAAQA,IAAQhI,IAAI,SAAUuM,GAC9F,OAAOA,EAAKzC,WAAW5D,EAASE,YAI7BlH,EAAG4N,WAAW9L,MAAM,YAAYiF,MAAM,GAAGgH,MAAM,SAAUwB,GAC5D,OAAOvP,EAAG0G,WAAW8I,YAAY,aAAc,CAAE1G,IAAKA,GAAOyG,EAAWzK,GAAI,CAAE2K,WAAW,QAGlGrN,KAAK,WACJ,OAAOpC,EAAG4N,WAAW9L,MAAM,OAAO8J,OAAO9C,GAAK2H,OAAO,SAAUrR,GAC3DA,EAAK6J,OAASjC,EAASE,eAKvClH,EAAGkJ,SAASmG,QAAU,SAAUlC,EAAcrE,EAAKnB,GAC/CA,EAAUA,GAAW,GACrB,IAAIF,EAAmB1I,EAAS2R,oBAAoBvD,GACpD,OAAI1F,EACO2H,EAAgB3H,EAAkB0F,EAAcrE,EAAKnB,GAGrDzI,EAAQoJ,OAAO,IAAIuF,MAAM,kBAAoBV,EAAe,kEAG3EnN,EAAGkJ,SAAS6C,OAAS,SAAUjD,GAC3B,OAAO9I,EAAGkJ,SAAS0B,WAAW9B,GAAK1G,KAAK,WACpC,OAAOpC,EAAGe,YAAY,MAAOf,EAAG4N,WAAY5N,EAAGgF,SAAUhF,EAAGkL,oBAAqB,WAK7E,IAAIyF,EACJ,OAAO3Q,EAAG4N,WACL9L,MAAM,OAAO8J,OAAO9C,GACpB+C,QAAQ,SAAU+E,GAAS,OAAOA,EAAM9P,IAAI,SAAU1B,GAAQ,OAAOA,EAAK0F,OAC1E1C,KAAK,SAAUyO,GAGhB,OAFAF,EAAkBE,EAEX7Q,EAAG4N,WAAW9L,MAAM,MAAMC,MAAM8O,GAAS9E,WAE/C3J,KAAK,WAEN,OAAOpC,EAAGkL,oBAAoBpJ,MAAM,QAAQC,MAAM4O,GAAiB5E,aAExE3J,KAAK,WAKJ8M,EAAW4B,iBAAiB9Q,QAIxCA,EAAGkJ,SAAS6H,gBAAkB,SAAUjI,GACpC,OAAO9I,EAAG4N,WAAW9L,MAAM,OAAO8J,OAAO9C,GAAKiF,MAAM,SAAU3O,GAC1D,OAAOY,EAAGgF,SAASlD,MAAM,OAAOiF,MAAM3H,EAAK8D,YAAY2I,aAG/D7L,EAAGgR,MAAQ/B,EAASjP,EAAGgR,MAAO,SAAUC,GACpC,OAAO,WAIH,OAHA/D,EAAY/M,QAAQ,SAAUkN,GAC1BA,EAAKzC,eAEFqG,EAAUC,MAAMlS,KAAMmS,cAGrCxQ,OAAOyQ,eAAepR,EAAG0G,WAAWwH,SAAS5O,UAAW,OAAQ,CAC5D+R,YAAY,EACZC,cAAc,EACdC,UAAU,EACVzL,MAAO,WACH,IAAI0L,EAAQxS,KACZ,OAAOgB,EAAGe,YAAY,MAAOf,EAAG4N,WAAY,WACxC,OAAO5N,EAAG4N,WAAWK,IAAIuD,QAgCzC,OA3BAzS,EAASiI,SAAWA,EACpBjI,EAAS0S,YA5jBS,CACdC,KAAM,QACNC,EAAK,UACLC,EAAK,aACLC,EAAK,SACLC,EAAK,UACLC,EAAK,oBAujBThT,EAAS2R,oBAAsB,GAC/B3R,EAASiT,qBAAuB,SAAUrL,EAAMc,GAM5C,IAAItD,EAAoBsD,EAAiBtD,kBACzC,GAAiC,iBAAtBA,GAEP,GAAIqF,MAAMrF,IAAsBA,EAAoB,EAChD,MAAM,IAAI0J,MAAM,4DAMpBpG,EAAiBtD,kBAAoBpB,EAAAA,EAEzChE,EAAS2R,oBAAoB/J,GAAQc,GAGzC3I,EAAMC,SAAWA,EACjBD,EAAMmT,OAAOxR,KAAK1B,GAEXA"}